"use strict";function _createForOfIteratorHelper(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,c=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){c=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(c)throw i}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}jQuery(function(e){e(document.body).on("updated_shipping_method",function(){o()}).on("updated_wc_div",function(){o()}).on("updated_checkout",function(){o()});var t=wp.i18n,n=t.__,r=(t._x,t._n,t._nx,"");function o(){var t=document.getElementsByClassName("wms_pickup_open_modal_mondial_relay");if(0!==t.length){var n,o=_createForOfIteratorHelper(t);try{for(o.s();!(n=o.n()).done;){n.value.addEventListener("click",function(){e(this).WCBackboneModal({template:this.getAttribute("wms-pickup-modal-id")}),r=document.getElementById(this.getAttribute("wms-pickup-modal-id")),r.querySelector(".wc-backbone-modal-loader"),i()})}}catch(e){o.e(e)}finally{o.f()}}}function i(){var t,o,i,a,c,u,l="75000",p=document.getElementById("billing_postcode"),s=document.getElementById("shipping_postcode");""!==p.value&&(l=p.value),""!==s.value&&(l=s.value);var d="FR",m=document.getElementById("billing_country"),_=document.getElementById("shipping_country");""!==m.value&&(d=m.value),""!==_.value&&(d=_.value),e(".wms_pickup_modal_map").MR_ParcelShopPicker({Target:"#wms_pickup_point",TargetDisplayInfoPR:"#wms_pickup_selected",Brand:"CC21X9MZ",Country:d,PostCode:l,Responsive:!0,NbResults:19,OnParcelShopSelected:function(e){t=e.ID,o=e.Nom,i=e.Adresse1,a=e.CP,c=e.Ville,u=e.Pays}}),e("#wms_select_point").on("click",function(){if(null!=o){var l=[o,i,c+" "+a,u],p=e("#wms_ajax_error"),s=e("#wms_pickup_selected"),d=e("#wms_nonce").val();confirm(sprintf(n("Please confirm you would like to ship here: %s","wc-multishipping"),"\n\n"+l.join("\n")))&&e.ajax({url:ajaxurl,type:"POST",dataType:"json",data:{action:"wms_select_pickup_point",pickup_id:t,pickup_name:o,pickup_address:i,pickup_zipcode:a,pickup_city:c,pickup_country:u,wms_nonce:d},beforeSend:function(){p.hide()},success:function(t){!1===t.error?(s.html("<div>"+l.join("</div><div>")+"</div>"),e("#wms_pickup_info").innerText=JSON.stringify(l),r.querySelector(".modal-close").click(),e("body").trigger("update_checkout")):(p.html(t.error_message),p.show())}})}else r.querySelector(".modal-close").click()})}});